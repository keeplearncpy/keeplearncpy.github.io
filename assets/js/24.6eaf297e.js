(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{733:function(t,s,a){"use strict";a.r(s);var n=a(5),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("说明")]),t._v(" "),a("p",[t._v("这是react学习笔记的摘要内容，主要包括setState的使用，")])]),t._v(" "),a("h2",{attrs:{id:"一、-setstate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、-setstate"}},[t._v("#")]),t._v(" 一、 setState")]),t._v(" "),a("h3",{attrs:{id:"_1-为什么要使用settstate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么要使用settstate"}},[t._v("#")]),t._v(" 1. 为什么要使用settState")]),t._v(" "),a("ul",[a("li",[t._v("因为在react中，没有做数据劫持，所以当我们修改state的值的时候，不会自动调用render方法，所以我们需要使用setState方法来修改state的值，这样就会自动调用render方法，从而更新视图。")]),t._v(" "),a("li",[t._v("在react中，如果我们想要更新组件的状态，那么就需要使用setState方法，而不是直接修改state的值，这是因为setState方法会自动调用render方法，而直接修改state的值不会调用render方法，所以我们在修改state的值的时候，需要使用setState方法。")]),t._v(" "),a("li",[t._v("在react中，没有做类似于vue2中的Object.defineProperty和vue3中Proxy的数据劫持，所以当我们修改state的值的时候，不会自动调用render方法，我们必须通过setState方法来修改state的值，这样就会自动调用render方法，从而更新视图。")])]),t._v(" "),a("h3",{attrs:{id:"_2-setstate的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-setstate的使用"}},[t._v("#")]),t._v(" 2. setState的使用")]),t._v(" "),a("ul",[a("li",[t._v("setState方法接收两个参数，第一个参数是一个对象，第二个参数是一个回调函数，这个回调函数会在state更新完成并且视图更新之后执行。")]),t._v(" "),a("li",[t._v("setState方法是异步的，所以如果我们想要获取到更新之后的state的值，那么就需要在setState方法的第二个参数中获取。")])]),t._v(" "),a("h3",{attrs:{id:"_3-setstate异步更新的原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-setstate异步更新的原因"}},[t._v("#")]),t._v(" 3. setState异步更新的原因")]),t._v(" "),a("ul",[a("li",[t._v("setState方法是异步的，这是因为在react中，如果我们在一个生命周期函数中调用setState方法，那么react会把这个setState方法放到一个队列中，然后等到这个生命周期函数执行完毕之后，再去执行这个队列中的setState方法，这样就可以减少不必要的性能损耗。")]),t._v(" "),a("li",[t._v("可以显著提升性能，如果每次调用setState都进行一次更小，那么意味着render函数会被频繁调用，界面重新渲染，这样效率很低。")]),t._v(" "),a("li",[t._v("如果同步更新了state，但是还没有执行render函数，那么state和props就不能保持同步，这样就会导致一些问题，所以react就把setState方法放到了一个队列中，等到render函数执行的时候，再去执行这个队列中的setState方法，这样就可以保证state和props的同步。")]),t._v(" "),a("li",[t._v("如果我们想要获取到更新之后的state的值，那么就需要在setState方法的第二个参数中获取。")]),t._v(" "),a("li",[t._v("redux设计异步的原因")]),t._v(" "),a("li",[t._v("https://github.com/facebook/react/issues/11527#issuecomment-360199710")])]),t._v(" "),a("h3",{attrs:{id:"_4-setstate在18之前与之后的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-setstate在18之前与之后的区别"}},[t._v("#")]),t._v(" 4. setState在18之前与之后的区别")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("在18之前")]),t._v(" "),a("ul",[a("li",[t._v("在组件生命周期或者react合成事件中调用setState方法，那么setState方法就是异步的。")]),t._v(" "),a("li",[t._v("在原生DOM事件或者setTimeout中调用setState方法，那么setState方法就是同步的。")])])]),t._v(" "),a("li",[a("p",[t._v("在18之后")]),t._v(" "),a("ul",[a("li",[t._v("setstate方法都是异步的，不管是在组件生命周期、react合成事件、原生DOM事件、setTimeout中调用setState方法，都是异步的。")])])])]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("App")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ChangeFn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//基本用法1：对象式的setState")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你好，世界'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 18之前同步情况")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// setTimeout(()=>{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     this.setState({")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//         message:'你好，世界'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     })")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     console.log(this.state.message)")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// },0)")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//基本用法2：函数式的setState")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.setState((state,props)=>{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     console.log(state,props)")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     return {")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//         message:'你好，世界'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     }")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// })")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//方式三：第一个参数是对象，第二个参数是回调函数")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果需要在数据更新之后，获取到对应的结果执行一些逻辑代码")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this.setState({message:'你好，世界'},()=>{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     console.log('回调函数')")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// })")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("setState详细调用")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ChangeFn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("点击一下")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" App\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br"),a("span",{staticClass:"line-number"},[t._v("48")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);